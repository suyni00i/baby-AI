---
title: 'ggplot2: 4. Summarized Data Distributions'
author: "suyni00i"
date: "2023-05-16"
output: html_document
---

```{r}
library(ggplot2)
library(gcookbook)
```

# Making a Basic Histogram
```{r}
ggplot(faithful, aes(x = waiting)) + geom_histogram()
```

```{r}
w <- rnorm(100)
ggplot(NULL, aes(x = w)) + geom_histogram()
# NULL: if data != dataframe
```
> geom_histogram(): histogram of ccontinuous variable

```{r}
ggplot(faithful, aes(x = waiting)) +
  geom_histogram(binwidth = 5, fill = "white", color = "black")
```

```{r}
binsize <- diff(range(faithful$waiting)) / 15
ggplot(faithful, aes(x = waiting)) +
  geom_histogram(binwidth = binsize, fill = "white", color = "black")
```
> diff(range(faithful$waiting)) / 15: set _/15_ of range of _waiting_

# Making Multiple Histograms from Grouped Data
```{r}
library(MASS)
ggplot(birthwt, aes(x = bwt)) + geom_histogram(fill = "white", color = "black") +
  facet_grid(smoke ~ .)
```
> facet_grid(smoke ~ .): show graphic accd to level of _smoke_

```{r}
# scale = "free"
ggplot(birthwt, aes(x = bwt)) + geom_histogram(fill = "white", color = "black") +
  facet_grid(race ~., scale = "free")
```
> scale = "free": release matching each panel's axis

```{r}
# change the facet
ggplot(birthwt, aes(x = bwt)) + geom_histogram(fill = "white", color = "black") +
  facet_grid(. ~ race)
```
> facet_grid(var ~ .): vertical
> facet_grid(. ~ var): horizontal

```{r}
birthwt1 <- birthwt
birthwt1$smoke <- factor(birthwt1$smoke, level = c(0, 1), labels = c("No Smoke", "Smoke"))
ggplot(birthwt1, aes(x = bwt, fill = smoke)) +
  geom_histogram(position = "identity", alpha = 0.4)
# fill = smoke, geom_histogram(position = "identity"): two histogram overlapped on one sheet
```

# Making a Density Curve
```{r}
ggplot(faithful, aes(x = waiting)) + geom_density()
```

```{r}
ggplot(faithful, aes(x = waiting)) + geom_line(stat = "density") + expand_limits(y = 0)
```
> geom_density(): show density curve of continuous variable
> geom_line(stat = "density"): density curve w/ below opened
> expand_limits(y = 0): y range starting from 0

```{r}
# adding colors
ggplot(faithful, aes(x = waiting)) +
  geom_density(fill = "blue", color = NA, alpha = 0.2) +
  geom_line(stat = "density") +
  # delete below 
  xlim(35, 105)
```
> xlim(35, 105): set range of x-axis as _35_ to _105_

```{r}
ggplot(faithful, aes(x = waiting)) +
  geom_line(stat = "density", adjust = 0.25, color = "red") +
  geom_line(stat = "density") +
  geom_line(stat = "density", adjust = 2, color = "blue")
# adjust: edit binwith
```

```{r}
ggplot(faithful, aes(x = waiting, y = ..density..)) +
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() + xlim(35, 105)
# ..density..: internal variable, auto-generated by geom_density()
```

# Making Multiple Density from Grouped Data
```{r}
birthwt1 <- birthwt
birthwt1$smoke <- factor(birthwt1$smoke)
ggplot(birthwt1, aes(x = bwt, color = smoke)) + geom_density()
```

```{r}
ggplot(birthwt1, aes(x = bwt, fill = smoke)) + geom_density(alpha = 0.3)
```

# Making a Basic Box Plot
```{r}
ggplot(birthwt, aes(x = factor(race), y = bwt)) + geom_boxplot()
```

```{r}
ggplot(birthwt, aes(x = factor(race), y = bwt)) + geom_boxplot(width = 0.5)
# width = 0.5: set width of _0.5_ (default = 0.9)
```
> geom_boxplot(): show boxplot of var2(continuous variation) for each var1

```{r}
ggplot(birthwt, aes(x = factor(race), y = bwt)) +
  geom_boxplot(outlier.size = 3, outlier.shape = 21)
# outlier.size: size of outlier
# outlier.shape: shape of outlier
# outlier.colour: colour of outlier
```

```{r}
# boxplot for single data
ggplot(birthwt, aes(x = 1, y = bwt)) + geom_boxplot() +
  scale_x_continuous(breaks = NULL) +
  theme(axis.title.x = element_blank())
```

# Adding Means to a Box Plot
```{r}
ggplot(birthwt, aes(x =factor(race), y = bwt)) + geom_boxplot() +
  stat_summary(fun = "mean", geom = "point", shape = 23, size = 3, fill = "white")
# show as point on graph
```
> stat_summary(): get mean w/ function
> fun.y = "mean": get mean of var(y)

# Making a Basic Dot Plot
```{r}
countries2009 <- subset(countries, Year == 2009 & healthexp > 2000)
p <- ggplot(countries2009, aes(x = infmortality))
p + geom_dotplot()
```
> geom_dotplot(): show dotplot

```{r}
p + geom_dotplot(binwidth = 0.25) + geom_rug() +
  scale_y_continuous(breaks = NULL) + # remove tick marks
  theme(axis.title.y = element_blank()) # remove axis label
```

```{r}
p + geom_dotplot(binwidth = 0.25, stackdir = "center") +
  # stackdir = "center": align dotplot in middle
  scale_y_continuous(breaks = NULL) + # remove tick marks
  theme(axis.title.y = element_blank()) # remove axis level
```

# Making a Density Plot of Two-Dimensional Data
```{r}
p <- ggplot(faithful, aes(x = eruptions, y = waiting))
p + geom_point() + stat_density2d()
```

```{r}
p + stat_density2d()
```
> stat_density2d(): predict and show curve of 2d data

```{r}
p + stat_density2d(aes(color = ..level..))
# ..level..: internal variable of stat_density2d(), (height of contour line)
```

```{r}
p + stat_density2d(aes(fill = ..density..), geom = "raster", contour = FALSE)
# fill = ..density..: set colour accd to predicted density function
```

```{r}
p + geom_point() +
  stat_density2d(aes(alpha = ..density..), geom = "tile", contour = FALSE)
# alpha = ..density..: set transparency accd to predicted density function
```